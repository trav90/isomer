# isomer readme

_isomer_ is a framework to generate packages of Pale Moon from the archives
generated by the Mozilla build process.

At present, Debian, Ubuntu and all RPM based distributions are supported.
Support for other distributions can be added by writing a module for that
distribution.

## Usage

_isomer_ generates packages for the distribution on which it is being run on. To
generate a package, type:

	./isomer INPUT_FILE OUTPUT_DIR [OPTIONS]

where:
- `INPUT_FILE` is the archive generated by the Mozilla build process.
- `OUTPUT_DIR` is a directory where the built packages are copied to.
- `OPTIONS` are passed onto the modules, for further processing.

The `dpkg-*` modules require a configuration file defining the variables
`MAINTAINER_NAME` and `MAINTAINER_EMAIL` to be stored in
`~/.config/isomer/dpkg.conf`.

## Details

`isomer` tries to detect the distribution it is running on, and accordingly
defines a name uniquely identifying that distribution (`$TARGET_DISTRO`). It
then lays out the minimal filesystem structure required for packaging, and then
invokes the module with this name.

At present, the following names are used:

- Debian: `dpkg-debian`
- Ubuntu: `dpkg-ubuntu`
- All RPM distributions: `rpm-generic`

Rules for writing modules:

- The module handling packaging should be placed under `/modules/$TARGET_DISTRO/
$TARGET_DISTRO`. Any additional scripts that are used are placed in `/modules/
$TARGET_DISTRO/<script>`. Scripts for general usage can be placed under
`/modules/common`. These directories are added to the `PATH` variable.

- Files/directories required by the modules can be placed in `/data/
$TARGET_DISTRO` and are accessible with `$MODULE_DATA_DIR`; those meant for
general usage can be stored in `/data/common` and are accessible as
`$COMMON_DATA_DIR`.

- The modules must move the generated package to the directory specified as its
first argument.

- Configuration data is stored in `~/.config/isomer`, this location can be
accessed with `$ISOMER_CONFIG_DIR`.
